{"version":3,"sources":["webpack:///webpack/bootstrap cadb539bbdc7998d7265","webpack:///./D:/workspace/javascript/universal-react-mobx/server/app.js","webpack:///external \"react\"","webpack:///external \"express\"","webpack:///./server/config/config.json","webpack:///external \"events\"","webpack:///external \"fs\"","webpack:///external \"mobx-react\"","webpack:///./D:/workspace/javascript/universal-react-mobx/common/App.jsx","webpack:///./D:/workspace/javascript/universal-react-mobx/common/pages/Base.jsx","webpack:///./D:/workspace/javascript/universal-react-mobx/common/pages/index/IndexPage.jsx","webpack:///./D:/workspace/javascript/universal-react-mobx/common/stores/index.js","webpack:///./D:/workspace/javascript/universal-react-mobx/server/apis/index.js","webpack:///./D:/workspace/javascript/universal-react-mobx/server/controllers/index.js","webpack:///./D:/workspace/javascript/universal-react-mobx/server/routes/index.js","webpack:///./D:/workspace/javascript/universal-react-mobx/server/utils/allowCrossDomain.js","webpack:///./D:/workspace/javascript/universal-react-mobx/server/utils/renderReactMiddleware.jsx","webpack:///external \"body-parser\"","webpack:///external \"compression\"","webpack:///external \"cookie-parser\"","webpack:///external \"csurf\"","webpack:///external \"ejs\"","webpack:///external \"express-session\"","webpack:///external \"helmet\"","webpack:///external \"http\"","webpack:///external \"mobx\"","webpack:///external \"morgan\"","webpack:///external \"react-dom/server\""],"names":["app","set","IP","PORT","disable","use","contentSecurityPolicy","frameguard","noSniff","xssFilter","hsts","json","urlencoded","extended","resave","secret","key","saveUninitialized","cookie","httpOnly","static","__dirname","maxAge","req","res","next","locals","csrftoken","csrfToken","err","console","dir","status","error","stack","render","message","process","on","reason","p","warn","server","createServer","listen","get","address","port","log","serverName","mediator","App","constructor","props","context","getChildContext","$eventBus","$appConfig","appConfig","componentDidMount","componentDidUpdate","componentWillUnmount","Children","only","children","defaultProps","propTypes","object","childContextTypes","instanceOf","eventMatchReg","getEventMethodsProps","instance","methods","Object","getOwnPropertyNames","filter","prop","test","instancePrototype","getPrototypeOf","prototype","concat","Base","__eventNames","__bindFunctions","funcBinded","bind","eventName","fn","Error","push","addListener","emit","args","off","events","index","indexOf","removeListener","splice","length","_reactInternalInstance","getName","name","hasOwnProperty","contextTypes","onReset","store","resetTimer","timer","IndexStore","setInterval","router","post","send","module","exports","renderReactHTML","component","appName","title","pageConfig","user","content","readFileSync","allowCrossDomain","allowedOrigins","origin","headers","header","getDefaultJSVersion","safeJSON","reactRender","defaultTemplate","webpackAssets","JSON","parse","ex","obj","stringify","replace","middlewareConfig","opts","template","data","needTransform","transformedData","transformer","html","assign","debug","query","application","debugName","state","version","jsVersion","js","finalLocals","css","pageStr","compileDebug"],"mappings":"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","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap cadb539bbdc7998d7265","import http from 'http';\nimport express from 'express';\nimport compress from 'compression';\nimport logger from 'morgan';\nimport cookieParser from 'cookie-parser';\nimport bodyParser from 'body-parser';\nimport session from 'express-session';\nimport csurf from 'csurf';\nimport config from './config/config.json';\nimport routes from './routes/index';\nimport apis from './apis/index';\nimport allowCrossDomain from './utils/allowCrossDomain'\nimport reactRender from './utils/renderReactMiddleware';\nimport helmet from 'helmet';\n// import socket from './sockets/socket';\n// import spaRenderMatch from './utils/spaRenderMatch';\n\nlet app = express();\n\napp.set('host', process.env.IP || '127.0.0.1');\napp.set('port', process.env.PORT || 3000);\napp.disable('x-powered-by');\n\napp.use(helmet.contentSecurityPolicy());\napp.use(helmet.frameguard());\napp.use(helmet.noSniff());\napp.use(helmet.xssFilter());\napp.use(helmet.hsts());\napp.use(compress());\napp.use(logger('dev'));\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(cookieParser());\napp.use(session({\n    resave: true,\n    secret: 'mySecretCookieSalt',\n    key: 'myCookieSessionId',\n    saveUninitialized: true,\n    cookie: {\n        httpOnly: true,\n    }\n}));\n\n// app.use(favicon(__dirname + '/../public/favicon.ico'));\napp.use('/static', express.static(__dirname + '/../public', {\n    maxAge: 86400000\n}));\n\n// if(process.env.NODE_ENV !== 'production'){\n//     let webpack = require('webpack');\n//     let config = require('../create-webpack.config')(true);\n//     let webpackDevMiddleware = require('webpack-dev-middleware');\n//     let webpackHotMiddleware = require('webpack-hot-middleware');\n//     let compiler = webpack(config);\n//     app.use(webpackDevMiddleware(compiler, { noInfo: true, publicPath: config.output.publicPath }));\n//     app.use(webpackHotMiddleware(compiler));\n// }\n\napp.use(allowCrossDomain);\n\napp.use(csurf());\napp.use(function (req, res, next) {\n    res.locals.csrftoken = req.csrfToken();\n    next();\n});\napp.use(reactRender());\n\napp.use('/api', apis);\napp.use('/', routes);\n// app.use('*', spaRenderMatch);\n\n// error handlers\n// no stacktraces leaked to user\napp.use(function(err, req, res, next) {\n    console.dir(err);\n    res.status(err.status || 500);\n    if(err.status === 500) {\n        console.error(err.stack);\n        res.json({error: 'Internal Server Error'});\n    }\n    else if(err.status === 404) {\n        res.render('error');    //render error page\n    } else {\n        res.json({error: err.message})\n    }\n});\n\n\nprocess.on('uncaughtException', err => {\n    console.error(err.message + '\\n' + err.stack);\n});\nprocess.on('unhandledRejection', (reason, p) => {\n    console.error(\"Unhandled Rejection at: Promise \", p, \" reason: \", reason);\n});\nprocess.on('rejectionHandled', (reason, p) => {\n    console.warn(\"rejectionHandled at: Promise \", p, \" reason: \", reason);\n});\n\nlet server = http.createServer(app);\n\n/* Socket.io Communication */\n// let io = require('socket.io').listen(server);\n// io.sockets.on('connection', socket);\n\nserver.listen(app.get('port'), app.get('host'), function() {\n    let { address, port } = server.address();\n    console.log(`${ config.serverName } server listening at http://%s:%s`, address, port);\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/server/app.js","module.exports = require(\"react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 2\n// module chunks = 0","module.exports = {\n\t\"application\": {\n\t\t\"version\": {\n\t\t\t\"css\": \"\",\n\t\t\t\"js\": \"\"\n\t\t},\n\t\t\"debugName\": \"test\"\n\t},\n\t\"serverName\": \"isomophic-react-redux-starter\"\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server/config/config.json\n// module id = 3\n// module chunks = 0","module.exports = require(\"events\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"events\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"mobx-react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mobx-react\"\n// module id = 6\n// module chunks = 0","import React, { Component, PropTypes } from 'react';\nimport EventEmitter from 'events';\n\nlet mediator = new EventEmitter();\n\nclass App extends Component {\n    constructor(props, context) {\n        super(props, context);\n    }\n\n    getChildContext(){\n        return {\n            $eventBus: mediator,\n            $appConfig: this.props.appConfig\n        }\n    }\n\n    componentDidMount(){\n    }\n\n    componentDidUpdate(){\n    }\n\n    componentWillUnmount(){\n    }\n\n    render() {\n        return React.Children.only(this.props.children);\n    }\n}\nApp.defaultProps = {\n    appConfig: null\n};\nApp.propTypes = {\n    appConfig: PropTypes.object\n};\nApp.childContextTypes = {\n    $eventBus: PropTypes.instanceOf(EventEmitter),\n    $appConfig: PropTypes.object\n};\n\nexport default App;\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/common/App.jsx","import React, { PropTypes, Component } from 'react';\nimport EventEmitter from 'events';\n\nconst eventMatchReg = /^on[A-Z]/;\nfunction getEventMethodsProps(instance){\n    let methods = Object.getOwnPropertyNames(instance)\n        .filter((prop) => {\n            return eventMatchReg.test(prop)\n                && typeof instance[prop] === 'function';\n        });\n\n    let instancePrototype = Object.getPrototypeOf(instance);\n    if(instancePrototype !== Object.prototype) {\n        methods = methods.concat(getEventMethodsProps(instancePrototype));\n    }\n\n    return methods\n}\n\n\nexport default class Base extends Component {\n    constructor(props, context){\n        super(props, context);\n\n        this.__eventNames = {};\n\n        this.__bindFunctions();\n    }\n\n    __bindFunctions(){\n        let props = getEventMethodsProps(this);\n        for(let prop of props){\n            if(!this[prop].funcBinded){\n                this[prop] = this[prop].bind(this);\n                this[prop].funcBinded = true;\n            }\n        }\n    }\n\n    on(eventName, fn){\n        if(typeof fn !== 'function') throw new Error('fn should be a function');\n\n        if(!this.__eventNames[eventName]){\n            this.__eventNames[eventName] = [fn];\n        } else {\n            this.__eventNames[eventName].push(fn);\n        }\n\n        return this.context.$eventBus.addListener(eventName, fn);\n    }\n\n    emit(eventName, ...args){\n        return this.context.$eventBus.emit(eventName, ...args);\n    }\n\n    off(eventName, fn){\n        let events = this.__eventNames[eventName];\n        if(events){\n            let index = events.indexOf(fn);\n\n            if(index >= 0) {\n                this.context.$eventBus.removeListener(eventName, fn);\n\n                events.splice(index, 1);\n\n                if(!events.length) {\n                    delete this.__eventNames[eventName];\n                }\n            } else {\n                console.warn('event: ' + eventName + ' is not registered in ' + this._reactInternalInstance.getName() + ' Component');\n            }\n\n            return true;\n        } else {\n            console.warn('event: ' + eventName + ' is not registered in ' + this.constructor.name + ' Component');\n\n            return false;\n        }\n    }\n\n    componentWillUnmount(){\n        for(let eventName in this.__eventNames){\n            if(this.__eventNames.hasOwnProperty(eventName)){\n                for(let fn of this.__eventNames[eventName]){\n                    this.off(eventName, fn);\n                }\n            }\n        }\n    }\n}\nBase.contextTypes = {\n    $eventBus: PropTypes.instanceOf(EventEmitter)\n};\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/common/pages/Base.jsx","import React, { Component } from 'react';\nimport { observer } from 'mobx-react';\nimport Base from '../Base';\n// import DevTools from 'mobx-react-devtools';\n\n@observer(['store'])\nclass App extends Base {\n    render() {\n        return (\n            <div>\n                <button onClick={this.onReset}>\n                    Seconds passed: {this.props.store.timer}\n                </button>\n                {/*<DevTools />*/}\n            </div>\n        );\n    }\n\n    onReset = () => {\n        this.props.store.resetTimer();\n    }\n}\n\nexport default App;\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/common/pages/index/IndexPage.jsx","import { observable } from 'mobx';\n\nclass IndexStore {\n    @observable timer = 0;\n\n    constructor() {\n        setInterval(() => {\n            this.timer += 1;\n        }, 1000);\n    }\n\n    resetTimer() {\n        this.timer = 0;\n    }\n}\n\nexport default IndexStore;\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/common/stores/index.js","import { Router } from 'express';\r\n\r\nlet router = new Router();\r\n\r\nrouter.post('/ajax', function(req, res, next){\r\n    if(error) {\r\n        next();\r\n    } else {\r\n        res.send('test')\r\n    }\r\n});\r\n\r\nexport default router;\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/server/apis/index.js","import React from 'react';\nimport Page from '../../common/pages/index/IndexPage';\nimport IndexStore from '../../common/stores/index';\n\n\nmodule.exports = function (req, res, next) {\n    res.renderReactHTML({\n        component: <Page/>,\n        store: new IndexStore(),\n        locals: {\n            appName: 'index',\n            title: 'index page'\n        },\n        pageConfig: {\n            user: 'test'\n        }\n    });\n};\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/server/controllers/index.js","import { Router } from 'express';\nimport fs from 'fs';\n\nlet router = new Router();\n\nimport IndexPage from '../controllers/index';\n\n\n/**\n * 首页请求\n */\nrouter.get('/', IndexPage);\n\n\n/**\n * 静态资源\n */\nlet content = fs.readFileSync(__dirname + '/../../client/js/utils/sw.js', 'utf8');\n\nrouter.get('/sw.js', async function(req, res){\n    res.set('Content-Type', 'application/javascript');\n    res.send(content);\n});\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/server/routes/index.js","\r\nexport default function allowCrossDomain(req, res, next) {\r\n    let allowedOrigins = [\r\n        'http://www.test.com'\r\n    ];\r\n    let origin = req.headers.origin;\r\n    if(allowedOrigins.indexOf(origin) > -1){\r\n        res.header('Access-Control-Allow-Origin', origin);\r\n    }\r\n    next();\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/server/utils/allowCrossDomain.js","import ejs from 'ejs';\nimport React from 'react';\nimport {renderToString} from 'react-dom/server';\nimport { Provider, useStaticRendering } from 'mobx-react'\nimport fs from 'fs';\n\nimport App from '../../common/App.jsx';\nimport config from '../config/config.json';\n\nuseStaticRendering(true);\n\nconst defaultTemplate = fs.readFileSync(__dirname + '/../views/index.html', 'utf8');\n\nexport function getDefaultJSVersion(name) {\n    let webpackAssets = fs.readFileSync(__dirname + '/../../webpack-assets.json', 'utf8');\n\n    try {\n        webpackAssets = JSON.parse(webpackAssets);\n    } catch (ex) {\n        console.log('webpack-assets.json parsed error');\n        webpackAssets = {};\n    }\n    return webpackAssets[name];\n}\n\nexport function safeJSON(obj){\n    return JSON.stringify(obj).replace(/<\\/script/gi, '<\\\\/script')\n        .replace(/<!--/g, '<\\\\!--');\n}\n\nexport default function reactRender(middlewareConfig = {}) {\n    return function (req, res, next) {\n        res.renderReactHTML = function (opts = {}) {\n            let {\n                template = '',\n                component = '',\n                data = {},\n                store = {},\n                locals = {},\n                pageConfig = {},\n                needTransform = true\n            } = opts;\n            let transformedData = (typeof middlewareConfig.transformer === 'function' && needTransform)\n                ? middlewareConfig.transformer(data) : data;\n            let html = '';\n            pageConfig = Object.assign(typeof middlewareConfig.appConfig === 'object'\n                ? middlewareConfig.appConfig : {}, pageConfig);\n\n            try {\n                html = renderToString((\n                    <Provider store={ store }>\n                        <App appconfig={ pageConfig }>\n                            { component }\n                        </App>\n                    </Provider>\n                ));\n            } catch (ex) {\n                html = 'internal server error: \\n' + ex.message;\n                console.error(ex.stack);\n            }\n\n            let debug = req.query.debug && (req.query.debug === config.application.debugName);\n            let state = data;\n            let version = config.application.version;\n            let jsVersion = '';\n            // prefer config version, useful when using CDN config\n            if (process.env.NODE_ENV === 'production') {\n                jsVersion = version && version.js;\n            } else {\n                jsVersion = getDefaultJSVersion(locals.appName || 'index');\n            }\n            template = template || middlewareConfig.defaultTemplate || defaultTemplate;\n\n            let finalLocals = Object.assign({\n                html,\n                state: safeJSON(data),\n                appName: 'index',\n                title: '',\n                test: process.env.NODE_ENV !== 'production',\n                debug,\n                appConfig: safeJSON(pageConfig),\n                version: {\n                    js: jsVersion,\n                    css: version && version.css\n                }\n            }, res.locals, locals);\n\n            let pageStr = ejs.render(template, finalLocals, {\n                compileDebug: false\n            });\n\n            res.status(200).send(pageStr);\n        };\n\n        next();\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/server/utils/renderReactMiddleware.jsx","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"compression\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"compression\"\n// module id = 17\n// module chunks = 0","module.exports = require(\"cookie-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cookie-parser\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"csurf\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"csurf\"\n// module id = 19\n// module chunks = 0","module.exports = require(\"ejs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ejs\"\n// module id = 20\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 21\n// module chunks = 0","module.exports = require(\"helmet\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"helmet\"\n// module id = 22\n// module chunks = 0","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 23\n// module chunks = 0","module.exports = require(\"mobx\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mobx\"\n// module id = 24\n// module chunks = 0","module.exports = require(\"morgan\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"morgan\"\n// module id = 25\n// module chunks = 0","module.exports = require(\"react-dom/server\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-dom/server\"\n// module id = 26\n// module chunks = 0"],"sourceRoot":""}