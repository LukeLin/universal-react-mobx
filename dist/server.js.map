{"version":3,"sources":["webpack:///webpack/bootstrap 16534768b5de4e7fafea","webpack:///./D:/workspace/javascript/universal-react-mobx/server/app.js","webpack:///external \"react\"","webpack:///external \"mobx-react\"","webpack:///external \"mobx\"","webpack:///./D:/workspace/javascript/universal-react-mobx/common/pages/Base.jsx","webpack:///./D:/workspace/javascript/universal-react-mobx/common/models/TodoModel.js","webpack:///./server/config/config.json","webpack:///external \"express\"","webpack:///external \"fs\"","webpack:///external \"react-router\"","webpack:///./D:/workspace/javascript/universal-react-mobx/common/App.jsx","webpack:///./D:/workspace/javascript/universal-react-mobx/common/stores/TimerStore.js","webpack:///./D:/workspace/javascript/universal-react-mobx/common/stores/TodoStore.js","webpack:///./D:/workspace/javascript/universal-react-mobx/server/middlewares/renderReactMiddleware.jsx","webpack:///external \"ejs\"","webpack:///external \"events\"","webpack:///external \"react-dom/server\"","webpack:///external \"secure-filters\"","webpack:///./D:/workspace/javascript/universal-react-mobx/common/components/todo/Todo.jsx","webpack:///./D:/workspace/javascript/universal-react-mobx/common/components/todo/TodoList.jsx","webpack:///./D:/workspace/javascript/universal-react-mobx/common/pages/App/About.jsx","webpack:///./D:/workspace/javascript/universal-react-mobx/common/pages/App/App.jsx","webpack:///./D:/workspace/javascript/universal-react-mobx/common/pages/timer/TimerPage.jsx","webpack:///./D:/workspace/javascript/universal-react-mobx/common/pages/todo/TodoPage.jsx","webpack:///./D:/workspace/javascript/universal-react-mobx/common/routes.js","webpack:///./D:/workspace/javascript/universal-react-mobx/common/stores/CommonStore.js","webpack:///./D:/workspace/javascript/universal-react-mobx/common/stores/spaStores.js","webpack:///./D:/workspace/javascript/universal-react-mobx/server/apis/index.js","webpack:///./D:/workspace/javascript/universal-react-mobx/server/controllers/Timer.js","webpack:///./D:/workspace/javascript/universal-react-mobx/server/controllers/Todo.js","webpack:///./D:/workspace/javascript/universal-react-mobx/server/middlewares/allowCrossDomain.js","webpack:///./D:/workspace/javascript/universal-react-mobx/server/middlewares/spaRenderMatch.jsx","webpack:///./D:/workspace/javascript/universal-react-mobx/server/routes/index.js","webpack:///./D:/workspace/javascript/universal-react-mobx/server/utils/preRender.js","webpack:///external \"body-parser\"","webpack:///external \"compression\"","webpack:///external \"cookie-parser\"","webpack:///external \"csurf\"","webpack:///external \"express-session\"","webpack:///external \"helmet\"","webpack:///external \"http\"","webpack:///external \"morgan\""],"names":["app","set","IP","PORT","disable","use","contentSecurityPolicy","frameguard","noSniff","xssFilter","hsts","json","urlencoded","extended","resave","secret","key","saveUninitialized","cookie","httpOnly","static","__dirname","maxAge","req","res","next","locals","csrftoken","csrfToken","err","console","dir","status","error","stack","render","message","process","on","reason","p","warn","server","createServer","listen","get","address","port","log","serverName","eventMatchReg","getEventMethodsProps","instance","methods","Object","getOwnPropertyNames","filter","prop","test","instancePrototype","getPrototypeOf","prototype","concat","Base","constructor","props","context","__eventNames","__bindFunctions","funcBinded","bind","eventName","fn","Error","push","$eventBus","addListener","emit","args","off","events","index","indexOf","removeListener","splice","length","_reactInternalInstance","getName","name","componentWillUnmount","hasOwnProperty","contextTypes","instanceOf","TodoModel","data","setFinished","finished","fromJS","object","DevTools","require","default","mediator","App","state","devTools","getChildContext","$appConfig","appConfig","componentDidMount","setState","componentDidUpdate","children","defaultProps","propTypes","childContextTypes","TimerStore","startTimer","setInterval","timer","resetTimer","TodoStore","unfinishedTodoCount","todos","todo","addTodo","removeTodo","todoStore","map","item","getDefaultJSVersion","reactRender","defaultTemplate","readFileSync","webpackAssets","JSON","parse","ex","middlewareConfig","renderReactHTML","opts","template","component","store","pageConfig","needTransform","html","assign","debug","query","application","debugName","version","jsVersion","js","appName","finalLocals","title","css","pageStr","compileDebug","send","Todo","onChange","onRemoveTodo","e","TodoList","onAddTodo","preventDefault","todoList","id","About","text","pageId","Children","only","TimerPage","onReset","TodoPage","ensure","requireModule","deps","callback","prevState","nextState","replace","cb","lastRoute","routes","location","pageComponent","OriginalPage","window","__APP_CONFIG__","CommonStore","configureStore","commonStore","common","timerStore","stores","BROWSER","__INITIAL_STATE__","router","post","module","exports","user","allowCrossDomain","allowedOrigins","origin","headers","header","renderMatch","history","time","Date","now","originalUrl","redirect","pathname","search","componentHTML","errorMsg","content","preRender","components","params","promises","current","WrappedComponent","fetchData","lastComponent","Promise","all"],"mappings":"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","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 16534768b5de4e7fafea","import http from 'http';\nimport express from 'express';\nimport compress from 'compression';\nimport logger from 'morgan';\nimport cookieParser from 'cookie-parser';\nimport bodyParser from 'body-parser';\nimport session from 'express-session';\nimport csurf from 'csurf';\nimport config from './config/config.json';\nimport routes from './routes/index';\nimport apis from './apis/index';\nimport allowCrossDomain from './middlewares/allowCrossDomain'\nimport reactRender from './middlewares/renderReactMiddleware';\nimport helmet from 'helmet';\n// import socket from './sockets/socket';\nimport spaRenderMatch from './middlewares/spaRenderMatch.jsx';\n\nlet app = express();\n\napp.set('host', process.env.IP || '127.0.0.1');\napp.set('port', process.env.PORT || 3000);\napp.disable('x-powered-by');\n\napp.use(helmet.contentSecurityPolicy());\napp.use(helmet.frameguard());\napp.use(helmet.noSniff());\napp.use(helmet.xssFilter());\napp.use(helmet.hsts());\napp.use(compress());\napp.use(logger('dev'));\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(cookieParser());\napp.use(session({\n    resave: true,\n    secret: 'mySecretCookieSalt',\n    key: 'myCookieSessionId',\n    saveUninitialized: true,\n    cookie: {\n        httpOnly: true,\n    }\n}));\n\n// app.use(favicon(__dirname + '/../public/favicon.ico'));\napp.use('/static', express.static(__dirname + '/../public', {\n    maxAge: 86400000\n}));\n\n// if(process.env.NODE_ENV !== 'production'){\n//     let webpack = require('webpack');\n//     let config = require('../create-webpack.config')(true);\n//     let webpackDevMiddleware = require('webpack-dev-middleware');\n//     let webpackHotMiddleware = require('webpack-hot-middleware');\n//     let compiler = webpack(config);\n//     app.use(webpackDevMiddleware(compiler, { noInfo: true, publicPath: config.output.publicPath }));\n//     app.use(webpackHotMiddleware(compiler));\n// }\n\napp.use(allowCrossDomain);\n\napp.use(csurf());\napp.use(function (req, res, next) {\n    res.locals.csrftoken = req.csrfToken();\n    next();\n});\napp.use(reactRender());\n\napp.use('/api', apis);\napp.use('/', routes);\napp.use('*', spaRenderMatch);\n\n// error handlers\n// no stacktraces leaked to user\napp.use(function(err, req, res, next) {\n    console.dir(err);\n    res.status(err.status || 500);\n    if(err.status === 500) {\n        console.error(err.stack);\n        res.json({error: 'Internal Server Error'});\n    }\n    else if(err.status === 404) {\n        res.render('error');    //render error page\n    } else {\n        res.json({error: err.message})\n    }\n});\n\n\nprocess.on('uncaughtException', err => {\n    console.error(err.message + '\\n' + err.stack);\n});\nprocess.on('unhandledRejection', (reason, p) => {\n    console.error(\"Unhandled Rejection at: Promise \", p, \" reason: \", reason);\n});\nprocess.on('rejectionHandled', (reason, p) => {\n    console.warn(\"rejectionHandled at: Promise \", p, \" reason: \", reason);\n});\n\nlet server = http.createServer(app);\n\n/* Socket.io Communication */\n// let io = require('socket.io').listen(server);\n// io.sockets.on('connection', socket);\n\nserver.listen(app.get('port'), app.get('host'), function() {\n    let { address, port } = server.address();\n    console.log(`${ config.serverName } server listening at http://%s:%s`, address, port);\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/server/app.js","module.exports = require(\"react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"mobx-react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mobx-react\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"mobx\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mobx\"\n// module id = 3\n// module chunks = 0","import React, { PropTypes, Component } from 'react';\nimport EventEmitter from 'events';\n\nconst eventMatchReg = /^on[A-Z]/;\nfunction getEventMethodsProps(instance){\n    let methods = Object.getOwnPropertyNames(instance)\n        .filter((prop) => {\n            return eventMatchReg.test(prop)\n                && typeof instance[prop] === 'function';\n        });\n\n    let instancePrototype = Object.getPrototypeOf(instance);\n    if(instancePrototype !== Object.prototype) {\n        methods = methods.concat(getEventMethodsProps(instancePrototype));\n    }\n\n    return methods\n}\n\n\nexport default class Base extends Component {\n    constructor(props, context){\n        super(props, context);\n\n        this.__eventNames = {};\n\n        this.__bindFunctions();\n    }\n\n    __bindFunctions(){\n        let props = getEventMethodsProps(this);\n        for(let prop of props){\n            if(!this[prop].funcBinded){\n                this[prop] = this[prop].bind(this);\n                this[prop].funcBinded = true;\n            }\n        }\n    }\n\n    on(eventName, fn){\n        if(typeof fn !== 'function') throw new Error('fn should be a function');\n\n        if(!this.__eventNames[eventName]){\n            this.__eventNames[eventName] = [fn];\n        } else {\n            this.__eventNames[eventName].push(fn);\n        }\n\n        return this.context.$eventBus.addListener(eventName, fn);\n    }\n\n    emit(eventName, ...args){\n        return this.context.$eventBus.emit(eventName, ...args);\n    }\n\n    off(eventName, fn){\n        let events = this.__eventNames[eventName];\n        if(events){\n            let index = events.indexOf(fn);\n\n            if(index >= 0) {\n                this.context.$eventBus.removeListener(eventName, fn);\n\n                events.splice(index, 1);\n\n                if(!events.length) {\n                    delete this.__eventNames[eventName];\n                }\n            } else {\n                console.warn('event: ' + eventName + ' is not registered in ' + this._reactInternalInstance.getName() + ' Component');\n            }\n\n            return true;\n        } else {\n            console.warn('event: ' + eventName + ' is not registered in ' + this.constructor.name + ' Component');\n\n            return false;\n        }\n    }\n\n    componentWillUnmount(){\n        for(let eventName in this.__eventNames){\n            if(this.__eventNames.hasOwnProperty(eventName)){\n                for(let fn of this.__eventNames[eventName]){\n                    this.off(eventName, fn);\n                }\n            }\n        }\n    }\n}\nBase.contextTypes = {\n    $eventBus: PropTypes.instanceOf(EventEmitter)\n};\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/common/pages/Base.jsx","import {\r\n    observable,\r\n    extendObservable,\r\n    action,\r\n    runInAction\r\n} from 'mobx';\r\n\r\nclass TodoModel {\r\n    id;\r\n    @observable title = '';\r\n    @observable finished = false;\r\n\r\n\tconstructor(data) {\r\n        runInAction('initialize TodoModel', () => {\r\n            extendObservable(this, data);\r\n        });\r\n\t}\r\n\r\n    @action\r\n    setFinished(finished) {\r\n        this.finished = finished\r\n    }\r\n\r\n    static fromJS(object) {\r\n        return new TodoModel(object);\r\n    }\r\n}\r\n\r\nexport default TodoModel;\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/common/models/TodoModel.js","module.exports = {\n\t\"application\": {\n\t\t\"version\": {\n\t\t\t\"css\": \"\",\n\t\t\t\"js\": \"\"\n\t\t},\n\t\t\"debugName\": \"test\"\n\t},\n\t\"serverName\": \"isomophic-react-redux-starter\"\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server/config/config.json\n// module id = 6\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"react-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-router\"\n// module id = 9\n// module chunks = 0","import React, { Component, PropTypes } from 'react';\r\nimport EventEmitter from 'events';\r\nimport { useStrict } from 'mobx';\r\n\r\nuseStrict(true);\r\n\r\n\r\nif(process.env.NODE_ENV !== 'production' && process.browser){\r\n    var DevTools = require('mobx-react-devtools').default;\r\n}\r\n\r\nlet mediator = new EventEmitter();\r\n\r\nclass App extends Component {\r\n    constructor(props, context) {\r\n        super(props, context);\r\n\r\n        this.state = {\r\n            devTools: null\r\n        };\r\n    }\r\n\r\n    getChildContext(){\r\n        return {\r\n            $eventBus: mediator,\r\n            $appConfig: this.props.appConfig\r\n        }\r\n    }\r\n\r\n    componentDidMount(){\r\n        if(DevTools) {\r\n            this.setState({\r\n                devTools: <DevTools/>\r\n            });\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(){\r\n    }\r\n\r\n    componentWillUnmount(){\r\n    }\r\n\r\n    render() {\r\n        // return React.Children.only(this.props.children);\r\n\r\n        return (\r\n            <div>\r\n                { this.props.children }\r\n                { this.state.devTools }\r\n            </div>\r\n        );\r\n    }\r\n}\r\nApp.defaultProps = {\r\n    appConfig: null\r\n};\r\nApp.propTypes = {\r\n    appConfig: PropTypes.object\r\n};\r\nApp.childContextTypes = {\r\n    $eventBus: PropTypes.instanceOf(EventEmitter),\r\n    $appConfig: PropTypes.object\r\n};\r\n\r\nexport default App;\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/common/App.jsx","import {\n    observable,\n    action,\n    runInAction\n} from 'mobx';\n\nclass TimerStore {\n    @observable timer = 0;\n\n    constructor() {\n        \n    }\n\n    @action\n    startTimer(){\n        setInterval(action('startTimer', () => {\n            this.timer += 1;\n        }), 1000);\n    }\n\n    @action\n    resetTimer() {\n        this.timer = 0;\n    }\n}\n\nexport default TimerStore;\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/common/stores/TimerStore.js","import {\r\n    observable,\r\n    computed,\r\n    extendObservable,\r\n    action,\r\n    runInAction\r\n} from 'mobx';\r\n\r\nimport TodoModel from '../models/TodoModel';\r\n\r\nclass TodoStore {\r\n    @observable todos = [];\r\n    @computed get unfinishedTodoCount() {\r\n        return this.todos.filter(todo => !todo.finished).length;\r\n    }\r\n\r\n    constructor(state = {}) {\r\n        // required in strict mode to be allowed to update state:\r\n        runInAction('initialize TodoStore', () => {\r\n            extendObservable(this, state);\r\n        });\r\n    }\r\n\r\n    @action\r\n    addTodo(todo) {\r\n        todo && this.todos.push(todo);\r\n    }\r\n\r\n    @action\r\n    removeTodo(index){\r\n        this.todos.splice(index, 1);\r\n    }\r\n\r\n    static fromJS(state) {\r\n        let todoStore = new TodoStore({\r\n            todos: state.todos.map(item => TodoModel.fromJS(item))\r\n        });\r\n        return todoStore;\r\n    }\r\n}\r\n\r\nexport default TodoStore;\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/common/stores/TodoStore.js","import ejs from 'ejs';\nimport React from 'react';\nimport { renderToString } from 'react-dom/server';\nimport { Provider, useStaticRendering } from 'mobx-react'\nimport { jsObj as safeJSON } from 'secure-filters';\nimport fs from 'fs';\n\nimport App from '../../common/App.jsx';\nimport config from '../config/config.json';\n\nuseStaticRendering(true);\n\nconst defaultTemplate = fs.readFileSync(__dirname + '/../views/index.html', 'utf8');\n\nexport function getDefaultJSVersion(name) {\n    let webpackAssets = fs.readFileSync(__dirname + '/../../webpack-assets.json', 'utf8');\n\n    try {\n        webpackAssets = JSON.parse(webpackAssets);\n    } catch (ex) {\n        console.log('webpack-assets.json parsed error');\n        webpackAssets = {};\n    }\n    return webpackAssets[name];\n}\n\nexport default function reactRender(middlewareConfig = {}) {\n    return function (req, res, next) {\n        res.renderReactHTML = function (opts = {}) {\n            let {\n                template = '',\n                component = '',\n                store = {},\n                locals = {},\n                pageConfig = {},\n                needTransform = true\n            } = opts;\n            let html = '';\n            pageConfig = Object.assign(typeof middlewareConfig.appConfig === 'object'\n                ? middlewareConfig.appConfig : {}, pageConfig);\n\n            try {\n                html = renderToString((\n                    <Provider store={store}>\n                        <App appconfig={pageConfig}>\n                            {component}\n                        </App>\n                    </Provider>\n                ));\n            } catch (ex) {\n                html = 'internal server error: \\n' + ex.message;\n                console.error(ex.stack);\n            }\n\n            let debug = req.query.debug && (req.query.debug === config.application.debugName);\n            let version = config.application.version;\n            let jsVersion = '';\n            // prefer config version, useful when using CDN config\n            if (process.env.NODE_ENV === 'production') {\n                jsVersion = version && version.js;\n            } else {\n                jsVersion = getDefaultJSVersion(locals.appName || 'index');\n            }\n            template = template || middlewareConfig.defaultTemplate || defaultTemplate;\n\n            let finalLocals = Object.assign({\n                html,\n                state: safeJSON(store),\n                appName: 'index',\n                title: '',\n                test: process.env.NODE_ENV !== 'production',\n                debug,\n                appConfig: safeJSON(pageConfig),\n                version: {\n                    js: jsVersion,\n                    css: version && version.css\n                }\n            }, res.locals, locals);\n\n            let pageStr = ejs.render(template, finalLocals, {\n                compileDebug: false\n            });\n\n            res.status(200).send(pageStr);\n        };\n\n        next();\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/server/middlewares/renderReactMiddleware.jsx","module.exports = require(\"ejs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ejs\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"events\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"events\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"react-dom/server\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-dom/server\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"secure-filters\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"secure-filters\"\n// module id = 17\n// module chunks = 0","import React, {PropTypes, Component} from 'react';\nimport {observer} from 'mobx-react';\nimport Base from '../../pages/Base';\n\n@observer\nclass Todo extends Base {\n    constructor(props, context) {\n        super(props, context);\n\n        // this.onChange = this.onChange.bind(this);\n        // this.removeTodo = this.removeTodo.bind(this);\n    }\n\n    onChange() {\n        let {todo} = this.props;\n\n        todo.setFinished(!todo.finished)\n    }\n\n    onRemoveTodo(e){\n        this.props.removeTodo(e, this.props.index);\n    }\n\n    render() {\n        let {todo, index} = this.props;\n\n        return (\n            <li>\n                <input\n                    type=\"checkbox\"\n                    checked={todo.finished}\n                    onChange={ this.onChange }\n                />{todo.title}\n                <button onClick={ this.props.addTodo }>add</button>\n                <button onClick={ this.onRemoveTodo }>remove</button>\n            </li>\n        );\n    }\n}\n\nexport default Todo;\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/common/components/todo/Todo.jsx","import React, { Component } from 'react';\nimport { observer } from 'mobx-react';\nimport Base from '../../pages/Base';\n\nimport Todo from './Todo';\nimport TodoModel from '../../models/TodoModel.js';\n\n@observer\nclass TodoList extends Base {\n    constructor(props, context) {\n        super(props, context);\n\n        // this.addTodo = this.addTodo.bind(this);\n        // this.removeTodo = this.removeTodo.bind(this);\n    }\n\n    onAddTodo(e) {\n        e.preventDefault();\n\n        let { todoList } = this.props;\n\n        todoList.addTodo(new TodoModel({\n            id: todoList.todos.length,\n            title: 'some text' + todoList.todos.length\n        }));\n    }\n\n    onRemoveTodo(e, index){\n        e.preventDefault();\n\n        let { todoList } = this.props;\n\n        todoList.removeTodo(index);\n    }\n\n    render() {\n        let { todoList } = this.props;\n\n        return (\n            <div>\n                <ul>\n                    {todoList.todos.map((todo, index) => {\n                        return (\n                            <Todo todo={todo}\n                        index={ index }\n                            key={todo.id} \n                            addTodo={this.onAddTodo}\n                            removeTodo={ this.onRemoveTodo }/>\n                        );\n                    })}\n                </ul>\n                Tasks left: {todoList.unfinishedTodoCount}\n            </div>\n        );\n    }\n}\n\nexport default TodoList;\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/common/components/todo/TodoList.jsx","import React, { Component } from 'react';\r\nimport { Link } from 'react-router';\r\nimport { observer } from 'mobx-react';\r\n\r\n\r\n@observer(['commonStore'])\r\nclass About extends Component {\r\n    static pageConfig = {\r\n        pageId: 'About'\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"about\">\r\n                this is about page\r\n                <Link to=\"/vote?debug=test\">vote</Link>\r\n                text: {this.props.text}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default About;\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/common/pages/App/About.jsx","import React, { PropTypes } from 'react';\r\n\r\nlet App = ({children}) => {\r\n    return (\r\n        React.Children.only(children)\r\n    );\r\n};\r\n\r\nApp.propTypes = {\r\n    children: PropTypes.object\r\n};\r\n\r\nexport default App;\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/common/pages/App/App.jsx","import React, { Component } from 'react';\nimport { observer } from 'mobx-react';\nimport Base from '../Base';\n\n@observer(['store'])\nclass TimerPage extends Base {\n    constructor(props, context){\n        super(props, context);\n    }\n\n    componentDidMount(){\n        this.props.store.startTimer();\n    }\n\n    render() {\n        return (\n            <div>\n                <button onClick={this.onReset}>\n                    Seconds passed: {this.props.store.timer}\n                </button>\n            </div>\n        );\n    }\n\n    onReset(){\n        this.props.store.resetTimer();\n    }\n}\n\nexport default TimerPage;\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/common/pages/timer/TimerPage.jsx","import React, { Component } from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport Base from '../Base';\r\n\r\nimport TodoList from '../../components/todo/TodoList';\r\n\r\n@observer(['store'])\r\nclass TodoPage extends Base {\r\n    constructor(props, context){\r\n        super(props, context);\r\n    }\r\n\r\n    render(){\r\n        return (\r\n            <TodoList todoList={ this.props.store }/>\r\n        );\r\n    }\r\n}\r\n\r\nexport default TodoPage;\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/common/pages/todo/TodoPage.jsx","import React from 'react';\r\nimport { Route, IndexRoute } from 'react-router';\r\nimport App from './pages/App/App';\r\n// import Vote from './universalPage/Vote';\r\nimport About from './pages/App/About';\r\n\r\n// require.ensure polyfill for node\r\nif (typeof require.ensure !== 'function') {\r\n    require.ensure = function requireModule(deps, callback) {\r\n        callback(require);\r\n    };\r\n}\r\n\r\nfunction onChange(prevState, nextState, replace, cb){\r\n    let lastRoute = nextState.routes[nextState.routes.length - 1];\r\n\r\n    if(lastRoute.component) {\r\n        let component = lastRoute.component;\r\n        let location = nextState.location;\r\n        let pageComponent = component.OriginalPage ? component.OriginalPage : component;\r\n\r\n        Object.assign(window.__APP_CONFIG__, {\r\n            pageId: location.query.pageId || (pageComponent.pageConfig && pageComponent.pageConfig.pageId)\r\n        });\r\n    }\r\n\r\n    cb();\r\n}\r\n\r\n\r\nexport default (store) => {\r\n    return (\r\n        <Route path=\"/\" component={App} onChange={ onChange }>\r\n            <IndexRoute getComponent={(nextState, cb) => {\r\n                require.ensure([], require => {\r\n                    cb(null, require('./pages/App/Vote').default);\r\n                }, 'Vote');\r\n            }}/>\r\n            <Route path=\"vote\" getComponent={(nextState, cb) => {\r\n                require.ensure([], require => {\r\n                    cb(null, require('./pages/App/Vote').default);\r\n                }, 'Vote');\r\n            }}/>\r\n            <Route path=\"about\" component={About} />\r\n        </Route>\r\n    );\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/common/routes.js","import {\r\n    observable,\r\n    action,\r\n    runInAction,\r\n    extendObservable\r\n} from 'mobx';\r\n\r\nclass CommonStore {\r\n    constructor(state = {}) {\r\n        runInAction('CommonStore init', () => {\r\n            extendObservable(this, state)\r\n        });\r\n    }\r\n}\r\n\r\nexport default CommonStore;\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/common/stores/CommonStore.js","import CommonStore from './CommonStore';\r\nimport TimerStore from './TimerStore';\r\nimport TodoStore from './TodoStore';\r\n\r\nexport default function configureStore(state = {}){\r\n    return {\r\n        commonStore: new CommonStore(state.common),\r\n        timerStore: new TimerStore(state.timer),\r\n        todoStore: new TodoStore(state.todo)\r\n    };\r\n}\r\n\r\nexport let stores = process.env.BROWSER ? stores(window.__INITIAL_STATE__) : {};\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/common/stores/spaStores.js","import { Router } from 'express';\r\n\r\nlet router = new Router();\r\n\r\nrouter.post('/ajax', function(req, res, next){\r\n    if(error) {\r\n        next();\r\n    } else {\r\n        res.send('test')\r\n    }\r\n});\r\n\r\nexport default router;\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/server/apis/index.js","import React from 'react';\nimport Page from '../../common/pages/timer/TimerPage.jsx';\nimport Store from '../../common/stores/TimerStore';\n\n\nmodule.exports = function (req, res, next) {\n    res.renderReactHTML({\n        component: <Page/>,\n        store: new Store(),\n        locals: {\n            appName: 'timer',\n            title: 'timer page'\n        },\n        pageConfig: {\n            user: 'test'\n        }\n    });\n};\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/server/controllers/Timer.js","import React from 'react';\r\nimport Page from '../../common/pages/todo/TodoPage.jsx';\r\nimport Store from '../../common/stores/TodoStore';\r\nimport TodoModel from '../../common/models/TodoModel';\r\n\r\n\r\nmodule.exports = function (req, res, next) {\r\n    let store = new Store();\r\n\r\n    store.addTodo(new TodoModel({\r\n        id: 0,\r\n        title: \"Get Coffee\"\r\n    }));\r\n    store.addTodo(new TodoModel({\r\n        id: 1,\r\n        title: \"Write simpler code\"\r\n    }));\r\n\r\n    store.todos[0].setFinished(true);\r\n\r\n    res.renderReactHTML({\r\n        component: <Page/> ,\r\n        store,\r\n        locals: {\r\n            appName: 'todo',\r\n            title: 'todo page'\r\n        },\r\n        pageConfig: {\r\n            user: 'test'\r\n        }\r\n    });\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/server/controllers/Todo.js","\r\nexport default function allowCrossDomain(req, res, next) {\r\n    let allowedOrigins = [\r\n        'http://www.test.com'\r\n    ];\r\n    let origin = req.headers.origin;\r\n    if(allowedOrigins.indexOf(origin) > -1){\r\n        res.header('Access-Control-Allow-Origin', origin);\r\n    }\r\n    next();\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/server/middlewares/allowCrossDomain.js","import React from 'react';\r\nimport {renderToString} from 'react-dom/server';\r\nimport {createMemoryHistory, match, RouterContext} from 'react-router';\r\nimport { Provider, useStaticRendering } from 'mobx-react';\r\nimport createRoutes from '../../common/routes';\r\nimport configureStore from '../../common/stores/spaStores.js';\r\nimport preRenderMiddleware from '../utils/preRender';\r\nimport ejs from 'ejs';\r\nimport config from '../config/config.json';\r\nimport { getDefaultJSVersion } from './renderReactMiddleware';\r\nimport App from '../../common/App.jsx';\r\nimport { jsObj as safeJSON } from 'secure-filters';\r\nimport fs from 'fs';\r\n\r\nconst defaultTemplate = fs.readFileSync(__dirname + '/../views/index.html', 'utf8');\r\n\r\n\r\nexport default function renderMatch(req, res) {\r\n    const history = createMemoryHistory();\r\n    const stores = configureStore({\r\n        common: {\r\n            user: {}\r\n        }\r\n    });\r\n    let appConfig = {\r\n        time: Date.now()\r\n    };\r\n    const routes = createRoutes(stores, appConfig);\r\n\r\n    match({routes, location: req.originalUrl}, async function (err, redirect, props){\r\n        if (err) {\r\n            res.status(500).json(err);\r\n        } else if (redirect) {\r\n            res.redirect(302, redirect.pathname + redirect.search);\r\n        } else if (props) {\r\n            let debug = req.query.debug && (req.query.debug === config.application.debugName);\r\n            let version = config.application.version;\r\n            let jsVersion = '';\r\n            // prefer config version, useful when using CDN config\r\n            if (process.env.NODE_ENV === 'production') {\r\n                jsVersion = version && version.js;\r\n            } else {\r\n                jsVersion = getDefaultJSVersion('app');\r\n            }\r\n            let componentHTML = '';\r\n            let errorMsg = '';\r\n\r\n            try {\r\n                await preRenderMiddleware(stores, props, appConfig, req);\r\n\r\n                componentHTML = renderToString(\r\n                    <Provider { ...stores }>\r\n                        <App appConfig={ appConfig }>\r\n                            <RouterContext {...props} />\r\n                        </App>\r\n                    </Provider>\r\n                );\r\n\r\n            } catch(ex){\r\n                errorMsg = ex.stack;\r\n                console.log(ex.stack)\r\n            }\r\n\r\n            let pageStr = ejs.render(defaultTemplate, Object.assign({\r\n                errorMsg,\r\n                html: componentHTML,\r\n                state: safeJSON(stores),\r\n                appName: 'app',\r\n                title: '',\r\n                test: process.env.NODE_ENV !== 'production',\r\n                debug: debug,\r\n                appConfig: safeJSON(appConfig),\r\n                version: {\r\n                    js: jsVersion,\r\n                    css: version && version.css\r\n                }\r\n            }, {}), {\r\n                compileDebug: false\r\n            });\r\n\r\n            res.status(200).send(pageStr);\r\n\r\n        } else {\r\n            res.redirect('/');\r\n        }\r\n    });\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/server/middlewares/spaRenderMatch.jsx","import { Router } from 'express';\r\nimport fs from 'fs';\r\n\r\nlet router = new Router();\r\n\r\nimport Timer from '../controllers/Timer';\r\nimport Todo from '../controllers/Todo';\r\n\r\n\r\n/**\r\n * 首页请求\r\n */\r\nrouter.get('/', Timer);\r\nrouter.get('/todo', Todo);\r\n\r\n\r\n/**\r\n * 静态资源\r\n */\r\nlet content = fs.readFileSync(__dirname + '/../../client/js/utils/sw.js', 'utf8');\r\n\r\nrouter.get('/sw.js', async function(req, res){\r\n    res.set('Content-Type', 'application/javascript');\r\n    res.send(content);\r\n});\r\n\r\nexport default router;\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/server/routes/index.js","function preRender(stores, { components, location, params }, appConfig = {}, req) {\r\n    const promises = components.map((current) => {\r\n        if(!current) return null;\r\n\r\n        const component = current.WrappedComponent ? current.WrappedComponent : current;\r\n        const pageConfig = component.OriginalPage && component.OriginalPage.pageConfig;\r\n\r\n        return component.fetchData ? component.fetchData({ stores, location, params, appConfig, pageConfig }, req) : null;\r\n    });\r\n\r\n    let lastComponent = components[components.length - 1].WrappedComponent ? components[components.length - 1].WrappedComponent : components[components.length - 1];\r\n    appConfig.pageId = lastComponent && lastComponent.OriginalPage && lastComponent.OriginalPage.pageConfig && lastComponent.OriginalPage.pageConfig.pageId;\r\n\r\n    return Promise.all(promises);\r\n}\r\n\r\nexport default preRender;\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/workspace/javascript/universal-react-mobx/server/utils/preRender.js","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 34\n// module chunks = 0","module.exports = require(\"compression\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"compression\"\n// module id = 35\n// module chunks = 0","module.exports = require(\"cookie-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cookie-parser\"\n// module id = 36\n// module chunks = 0","module.exports = require(\"csurf\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"csurf\"\n// module id = 37\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 38\n// module chunks = 0","module.exports = require(\"helmet\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"helmet\"\n// module id = 39\n// module chunks = 0","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 40\n// module chunks = 0","module.exports = require(\"morgan\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"morgan\"\n// module id = 41\n// module chunks = 0"],"sourceRoot":""}